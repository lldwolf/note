
<html><HEAD>
<LINK REL=STYLESHEET HREF="default.css" TYPE="text/css">
<TITLE>
CumulativePercent</TITLE>
</HEAD>
<BODY>
<A NAME="CAICHGHI"></A><A NAME="TI6463"></A><h1>CumulativePercent</h1>
<A NAME="TI6464"></A><p>
<FORM>
<INPUT
 TYPE = "BUTTON"
 VALUE = "Examples"
 onClick = "window.location = 'imugp166.htm#EX18';">
<INPUT
  TYPE = "BUTTON"
 VALUE = "See also"
 onClick = "window.location = 'imugp166.htm#SA18';">
</FORM>
</p>
<h3>Description</h3><A NAME="TI6465"></A><p>Calculates the total value of the rows up to and including
the current row in the specified column as a percentage of the total
value of the column (a running percentage).</p>

<h3>Syntax</h3><pre><b>CumulativePercent</b> ( <i>column</i> { FOR <i>range</i> } )</pre>
<A NAME="TI6466"></A><table cellspacing=0 cellpadding=6 border=1 frame="void" rules="all"><tr><th align="left" valign=bottom><A NAME="TI6467"></A>Argument</th>
<th align="left" valign=bottom><A NAME="TI6468"></A>Description</th>
</tr>
<tr><td valign=top><A NAME="TI6469"></A><i>column</i></td>
<td valign=top><A NAME="TI6470"></A>The column for which you want the cumulative
value of the rows up to and including the current row as a percentage
of the total value of the column for <i>range</i>. <i>Column</i> can
be the column name or the column number preceded by a pound sign
(#). <i>Column</i> can also be an expression
that includes a reference to the column. The data type of <i>column</i> must
be numeric</td>
</tr>
<tr><td valign=top><A NAME="TI6471"></A>FOR <i>range</i>  (optional)</td>
<td valign=top><A NAME="TI6472"></A>The data that will be included in the
cumulative percentage. For most presentation styles, values for <i>range</i> are:<A NAME="TI6473"></A><A NAME="TI6474"></A>
<ul>
<li class=fi>ALL -- (Default)
The cumulative percentage of all rows in <i>column</i></li>
<li class=ds>GROUP <i>n</i> -- The cumulative
percentage of rows in <i>column</i> in the specified
group. Specify the keyword GROUP followed by the group number: for
example, GROUP 1</li>
<li class=ds>PAGE -- The cumulative percentage of the
rows in <i>column</i> on a page
</li>
</ul>
<A NAME="TI6475"></A>For Crosstabs, specify CROSSTAB for <i>range</i>:<A NAME="TI6476"></A><A NAME="TI6477"></A>
<ul>
<li class=fi>CROSSTAB -- (Crosstabs
only) The cumulative percentage of all rows in <i>column</i> in
the crosstab
</li>
</ul>
<A NAME="TI6478"></A>For Graph and OLE objects, specify one of the following:<A NAME="TI6479"></A><A NAME="TI6480"></A>
<ul>
<li class=fi>GRAPH -- (Graphs
only) The cumulative percentage of values in <i>column</i> in
the range specified for the Rows option</li>
<li class=ds>OBJECT -- (OLE objects only) The cumulative
percentage of values in <i>column</i> in the range
specified for the Rows option
</li>
</ul>
</td>
</tr>
</table>

<h3>Return Values</h3><A NAME="TI6481"></A><p>Long. Returns the cumulative percentage value.</p>

<h3>Usage</h3><A NAME="TI6482"></A><p>If you specify <i>range</i>, CumulativePercent
restarts the accumulation at the start of the range.</p>
<A NAME="TI6483"></A><p>For graphs and OLE objects, you do not select the range when
you call the function. The range has already been determined by
the Rows setting on the Data property page (the Range property),
and the aggregation function uses that range. Settings for Rows
include:</p>
<A NAME="TI6484"></A><p><A NAME="TI6485"></A>
<ul>
<li class=fi>For the Graph or OLE
presentation style, Rows is always All.</li>
<li class=ds>For Graph controls, Rows can be All, Page, or Group.</li>
<li class=ds>For OLE controls, Rows can be All, Current Row,
Page, or Group. The available choices depend on the layer the control
occupies.
</li>
</ul>
</p>
<A NAME="TI6486"></A><p>In calculating the percentage, NULL values are ignored.</p>
<p><img src="images/note.gif" width=17 height=17 border=0 align="bottom" alt="Note"> <span class=shaded>Not in validation rules or filter expressions</span> <A NAME="TI6487"></A>You cannot use this or other aggregate functions in validation
rules or filter expressions.</p>
<A NAME="TI6488"></A><p>Using an aggregate function cancels the effect of setting
Retrieve Rows As Needed in the painter. To do the aggregation, a
DataWindow object or a report always retrieves all rows.</p>

<A NAME="EX18"></A><h3>Examples</h3><A NAME="TI6489"></A><p>This expression returns the running percentage for
the values that are not NULL in the column named salary:<pre><i>CumulativePercent</i> (salary)</pre>
</p>
<A NAME="TI6490"></A><p>This expression returns the running percentage for
the column named salary for the values in group 1 that are not NULL:<pre><i>CumulativePercent</i> (salary for group 1)</pre>
</p>
<A NAME="TI6491"></A><p>This expression entered in the Value box on the Data
property page for a graph returns the running percentage for the
salary column for the values in the graph that are not NULL:<pre><i>CumulativePercent</i> (salary for graph)</pre>
</p>
<A NAME="TI6492"></A><p>This expression in a crosstab computed field returns
the running percentage for the salary column for the values in the
crosstab that are not NULL:<pre><i>CumulativePercent</i> (salary for crosstab)</pre>
</p>

<A NAME="SA18"></A><h3>See Also</h3><A NAME="TI6493"></A><p><A NAME="TI6494"></A>
<ul>
<li class=fi><A HREF="imugp219.htm#CAIBGEIC">Percent</A></li>
<li class=ds><A HREF="imugp167.htm#CAIDHFDA">CumulativeSum</A>
</li>
</ul>
</p>


