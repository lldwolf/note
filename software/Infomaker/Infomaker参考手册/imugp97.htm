
<html><HEAD>
<LINK REL=STYLESHEET HREF="default.css" TYPE="text/css">
<TITLE>
Enhancing crosstabs </TITLE>
</HEAD>
<BODY>
<A NAME="X-ref352128873"></A><h1>Enhancing crosstabs </h1>
<A NAME="TI4015"></A><p>Once you have provided the data definitions, the crosstab
is functional. But you will probably want to enhance it before using
it. Because a crosstab is a grid report, you can enhance a crosstab
using the same techniques you use in other reports. For example,
you might want to:<A NAME="TI4016"></A>
<ul>
<li class=fi>Sort or
filter rows</li>
<li class=ds>Change the column headers</li>
<li class=ds>Specify fonts and borders</li>
<li class=ds>Specify column display formats
</li>
</ul>
</p>
<A NAME="TI4017"></A><p>For more on these and the other standard enhancements
you can make to reports, see <A HREF="imugp51.htm#CAICGCGD">Chapter 5, "Enhancing Reports "</A>.</p>
<A NAME="TI4018"></A><p>The rest of this section covers topics either unique to crosstabs
or especially important when working with crosstabs:<A NAME="TI4019"></A>
<ul>
<li class=fi><A HREF="imugp97.htm#CBBDJIGD">"Specifying basic properties"</A></li>
<li class=ds><A HREF="imugp97.htm#X-ref305405211">"Modifying the data
associated with the crosstab"</A></li>
<li class=ds><A HREF="imugp97.htm#CBBDEHFF">"Changing the names used
for the columns and rows"</A></li>
<li class=ds><A HREF="imugp97.htm#X-ref305405242">"Defining summary statistics"</A></li>
<li class=ds><A HREF="imugp97.htm#X-ref305463107">"Cross-tabulating ranges
of values"</A></li>
<li class=ds><A HREF="imugp97.htm#X-ref305373728">"Creating static crosstabs"</A></li>
<li class=ds><A HREF="imugp97.htm#X-ref305834959">"Using property conditional
expressions"</A>
</li>
</ul>
</p>
<A NAME="CBBDJIGD"></A><h2>Specifying basic properties</h2>
<A NAME="TI4020"></A><p>Crosstabs are implemented as grid reports, so you can
specify the following grid properties for a crosstab:<A NAME="TI4021"></A>
<ul>
<li class=fi>When grid lines are displayed</li>
<li class=ds>What is allowed when you run the report
</li>
</ul>
</p>
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To specify the crosstab's basic properties:</p>
<ol><li class=fi>
In the Properties view, select the General
tab.<br><br></li>
<li class=ds>
Specify basic crosstab properties as follows:<br><br><A NAME="TI4022"></A><table cellspacing=0 cellpadding=6 border=1 frame="void" rules="all"><tr><th align="left" valign=bottom><A NAME="TI4023"></A>Option</th>
<th align="left" valign=bottom><A NAME="TI4024"></A>Result</th>
</tr>
<tr><td valign=top><A NAME="TI4025"></A>Display</td>
<td valign=top><A NAME="TI4026"></A><i>On</i> -- Grid
lines always display<A NAME="TI4027"></A><i>Off</i> -- Grid lines never display
(columns cannot be resized during execution)<A NAME="TI4028"></A><i>Display Only</i> -- Grid lines display
only when the crosstab displays online<A NAME="TI4029"></A><i>Print Only</i> -- Grid lines display
only when the contents of the crosstab are printed</td>
</tr>
<tr><td valign=top><A NAME="TI4030"></A>Column Moving</td>
<td valign=top><A NAME="TI4031"></A>Columns can be moved during execution</td>
</tr>
<tr><td valign=top><A NAME="TI4032"></A>Mouse Selection</td>
<td valign=top><A NAME="TI4033"></A>Data can be selected during execution
(and, for example, copied to the clipboard)</td>
</tr>
<tr><td valign=top><A NAME="TI4034"></A>Row Resize</td>
<td valign=top><A NAME="TI4035"></A>Rows can be resized during execution</td>
</tr>
</table>
</li></ol>
<br><A NAME="X-ref305405211"></A><h2>Modifying the data associated with the crosstab</h2>
<A NAME="TI4036"></A><p>When you initially define the crosstab, you associate the
crosstab rows and columns with columns in a database table or other
data source. You can change the associated data anytime in the Crosstab
Definition dialog box.</p>
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To open the Crosstab Definition dialog box:</p>
<ol><li class=fi>
Position the mouse below the footer band
in the workspace and display the popup menu.<br><br></li>
<li class=ds>
Select Crosstab from the popup menu.<br><br>
The Crosstab Definition dialog box displays.<br><br></li></ol>
<br><p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To modify the data associated with a crosstab:</p>
<ol><li class=fi>
In the Crosstab Definition dialog box,
fill in the boxes for Columns, Rows, and Values as described in <A HREF="imugp94.htm#X-ref352128847">"Associating data with
a crosstab "</A>.<br><br></li>
<li class=ds>
Click OK.<br><br></li></ol>
<br><A NAME="CBBDEHFF"></A><h2>Changing the names used for the columns and rows</h2>
<A NAME="TI4037"></A><p>Sometimes names of columns in the database are not very user
friendly and may not be meaningful. You can change the names that
are used to label rows and columns in crosstabs so that the data
is easier to understand.</p>
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To change the names used in crosstabs:</p>
<ol><li class=fi>
In the Crosstab Definition dialog box,
double-click the name of the column in the Source Data box.<br><br>
The New Name dialog box displays:<br><br><br><img src="images/cros20.gif"><br>
</li>
<li class=ds>
Specify the name you want to be used to label
the corresponding column. You can have multiple-word labels by using
underscores: underscores are replaced by spaces in the workspace
and during execution.<br><br></li>
<li class=ds>
Click OK.<br><br>
InfoMaker changes the column name in the Source Data box
and anywhere else the column is used.<br><br></li></ol>
<br><A NAME="TI4038"></A><h4>Example</h4>
<A NAME="TI4039"></A><p>For example, if you want the Product column to be labeled <i>Printer
Model</i>
, double-click Product in the Crosstab Definition
dialog box and specify <pre>printer_model</pre>
 in
the New Name dialog box.</p>
<A NAME="TI4040"></A><p>When the crosstab runs, you will see this:</p>
<br><img src="images/cros22.gif">
<A NAME="X-ref305405242"></A><h2>Defining summary statistics</h2>
<A NAME="TI4041"></A><p>When you generate a crosstab, the columns and rows are automatically
totaled for you. You can include other statistical summaries in
crosstabs as well. To do that, you place computed fields in the
workspace.</p>
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To define a column summary:</p>
<ol><li class=fi>
Enlarge the summary band to make room for
the summaries.<br><br></li>
<li class=ds>
Select Insert&gt;Control&gt;Computed
Field from the menu bar.<br><br></li>
<li class=ds>
Click the cell in the summary band where you want
the summary to display.<br><br>
The Modify Expression dialog box displays.<br><br></li>
<li class=ds>
Define the computed field. <br><br>
For example, if you want the average value for a column specify <b>avg(units for
all)</b>, where Units is the column providing the
values in the crosstab.<br><br></li></ol>
<br><A NAME="TI4042"></A><p>Here is a crosstab that has been enhanced to show averages
and maximum values for each column. This is the Design view:</p>
<br><img src="images/cros23.gif">
<A NAME="TI4043"></A><p>And this is the crosstab during execution:</p>
<br><img src="images/cros24.gif">
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To define a row summary:</p>
<ol><li class=fi>
Select Insert&gt;Control&gt;Computed
Field from the menu bar.<br><br></li>
<li class=ds>
Click the empty cell to the right of the last
column in the detail band.<br><br>
The Modify Expression dialog box displays.<br><br></li>
<li class=ds>
Define the computed field. You should use one
of the crosstab functions, described next. <br><br></li></ol>
<br><A NAME="TI4044"></A><h3>Using crosstab functions</h3>
<A NAME="TI4045"></A><p>There are five special functions you can use only in crosstabs:
CrosstabAvg, CrosstabCount, CrosstabMax, CrosstabMin, and CrosstabSum.</p>
<A NAME="TI4046"></A><p>These functions are listed in the Functions box when you define
a computed field in a crosstab:</p>
<br><img src="images/cros25.gif">
<A NAME="TI4047"></A><p>Each of these functions returns the corresponding statistic
about a row in the crosstab (average, count, maximum value, minimum
value, or sum). You place computed fields using these functions
in the detail band in the Design view.</p>
<A NAME="TI4048"></A><p>By default, InfoMaker places CrosstabSum in the detail band,
which returns the total for the corresponding row.</p>
<A NAME="TI4049"></A><h4>How to specify the functions</h4>
<A NAME="TI4050"></A><p>Each of these functions takes one numeric argument, which
refers to the expression defined for Values in the Crosstab Definition
dialog box. The first expression for Values is numbered 1, the second
is numbered 2, and so on.</p>
<A NAME="TI4051"></A><p>Generally, crosstabs have only one expression for Values,
so the argument for the crosstab functions is 1. So, for example,
if you defined sum(units for crosstab) as your Values expression, InfoMaker places
CrosstabSum(1) in the detail band.</p>
<A NAME="TI4052"></A><p>But assume you want to cross-tabulate total unit sales and
also a projection for future sales, assuming a 20 percent increase
in sales (that is, sales that are 1.2 times the actual sales).</p>
<A NAME="TI4053"></A><p>You would define two expressions for Values:</p>
<br><img src="images/cros26.gif">
<A NAME="TI4054"></A><p>Here CrosstabSum(1) returns the total of sum(units for crosstab)
for the corresponding row. CrosstabSum(2) returns the total for
sum(units * 1.2 for crosstab).</p>
<A NAME="TI4055"></A><h4>For more information</h4>
<A NAME="TI4056"></A><p>For complete information about defining computed
fields, see <A HREF="imugp51.htm#CAICGCGD">Chapter 5, "Enhancing Reports "</A>.</p>
<A NAME="TI4057"></A><p>For more about the crosstab functions, see Chapter 23, "DataWindow Expression
and InfoMaker Functions".</p>
<A NAME="X-ref305463107"></A><h2>Cross-tabulating ranges of values</h2>
<A NAME="TI4058"></A><p>Often you want to build a crosstab where each row tabulates
a <i>range</i>
 of values, instead of one discrete
value. Similarly, you might want each column in the crosstab to
correspond to a range of values.</p>
<A NAME="TI4059"></A><p>For example, in cross-tabulating departmental salary information,
you might want one row in the crosstab to count all employees making
between $30,000 and $40,000, the next row to count
all employees making between $40,000 and $50,000,
and so on.</p>
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To cross-tabulate ranges of values:</p>
<ol><li class=fi>
Determine the expression that results in
the raw values being converted into one of a small set of fixed
values.<br><br>
Each of those values will form a row or column in the crosstab.<br><br></li>
<li class=ds>
Specify the expression in the Columns or Rows
box in the Crosstab Definition dialog box. You choose the box depending
on whether you want the columns or rows to correspond to the range
of values.<br><br></li>
<li class=ds>
In the Values column, apply the appropriate aggregate
function to the expression.<br><br></li></ol>
<br><A NAME="TI4060"></A><h4>Example</h4>
<A NAME="TI4061"></A><p>This is best illustrated with an example.</p>
<A NAME="TI4062"></A><p>You want to know how many employees in each department make
between $30,000 and $40,000, how many make between $40,000
and $50,000, how many make between $50,000 and $60,000,
and so on. To do this, you want a crosstab where each row corresponds
to a $10,000 range of salary.</p>
<A NAME="TI4063"></A><p>The first step is to determine the expression that, given
a salary, returns the next smaller salary that is a multiple of $10,000.
For example, given a salary of $34,000, the expression
would return $30,000, and given a salary of $47,000, the
expression would return $40,000. You can use the Int function
to accomplish this, as follows:</p>
<A NAME="TI4064"></A><p><pre>int(salary/10000) * 10000</pre>
</p>
<A NAME="TI4065"></A><p>That expression divides the salary by 10,000 and takes the
integer portion, then multiplies the result by 10,000. So for $34,000,
the expression returns $30,000, as follows:<pre>34000/10000 = 3.4<br> int(3.4) = 3<br> 3 * 10000 = 30000</pre>
</p>
<A NAME="TI4066"></A><p>With that information you can build the crosstab. The following
uses the Employee table in the EAS Demo DB:<A NAME="TI4067"></A>
<ol>
</li>
<li class=ds>Build a crosstab and retrieve the Dept_ID
and Salary columns.</li>
<li class=ds>In the Crosstab Definition dialog box, drag the
Dept_ID column to the Columns box.</li>
<li class=ds>Drag the Salary column to the Rows box and to the
Values box and edit the expressions.<br>
In the Rows box, use:<pre>int(salary/10000) * 10000</pre>
<br><br>
In the Values box, use:<pre>count(int(salary/10000) * 10000 for crosstab)</pre>
<br><br>
For more on providing expressions in a crosstab,
see <A HREF="imugp94.htm#X-ref305465003">"Using expressions"</A>.<br></li>
<li class=ds>Click OK.
</li>
</ol>
</p>
<A NAME="TI4068"></A><p>This is the result in the Design view:</p>
<br><img src="images/cros28.gif">
<A NAME="TI4069"></A><p>And here is the crosstab during execution:</p>
<br><img src="images/cros29.gif">
<A NAME="TI4070"></A><p>You can see, for example, that two people in department 400
and five in department 500 make between $20,000 and $30,000.</p>
<A NAME="TI4071"></A><h4>Displaying blank values as zero</h4>
<A NAME="TI4072"></A><p>In the crosstab above, several of the cells in the grid are
blank. There are no employees in some salary ranges, so the value
of those cells is null. To make the crosstab easier to read, you
can add a display format to fields that can have null values so
that they display a zero.</p>
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To display blank values in a crosstab as zero:</p>
<ol><li class=fi>
Select the column you want to modify and
click the Format tab in the Properties view.<br><br></li>
<li class=ds>
Replace [General] in the Format
box with <b>###0;###0;0;0</b>.<br><br>
The fourth section in the mask causes a null value to be represented
as zero.<br><br></li></ol>
<br><A NAME="X-ref305373728"></A><h2>Creating static crosstabs</h2>
<A NAME="TI4073"></A><p>By default, crosstabs are dynamic: when you run them, InfoMaker retrieves
the data and dynamically builds the columns and rows based on the
retrieved data. For example, if you have defined a crosstab that
computes sales of printers and a new printer type is entered in
the database after you defined the crosstab, you want the new printer
to be in the crosstab. That is, you want InfoMaker to dynamically
build the rows and columns based on current data, not the data that existed
when the crosstab was defined.</p>
<A NAME="TI4074"></A><p>Occasionally, however, you might want a crosstab to be static.
That is, you want its columns to be established when you define
the crosstab. You do not want additional columns to display in the
crosstab during execution; no matter what the data looks like, you
don't want the number of columns to change. You only want
the updated statistics for the predefined columns. Here is how to
do that.</p>
<p><img src="images/proc.gif" width=17 height=17 border=0 align="bottom" alt="Steps"> To create a static crosstab:</p>
<ol><li class=fi>
In the Wizard page or in the Crosstab Definition
dialog box, clear the Rebuild Columns At Runtime checkbox:<br><br><br><img src="images/cros30.gif"><br>
</li>
<li class=ds>
Define the data for the crosstab as usual.<br><br></li>
<li class=ds>
Click OK.<br><br></li></ol>
<br><A NAME="TI4075"></A><h4>What happens</h4>
<A NAME="TI4076"></A><p>With the checkbox cleared, instead of immediately building
the crosstab's structure, InfoMaker first retrieves the
data from the database. Using the retrieved data, InfoMaker then
builds the crosstab structure and displays the workspace. It places
all the values for the column specified in the Columns box in the
workspace. These values become part of the crosstab's definition.</p>
<A NAME="TI4077"></A><p>For example, in the following screen, the four values for
Quarter (Q1, Q2, Q3, and Q4) are displayed in the Design view:</p>
<br><img src="images/cros31.gif">
<A NAME="TI4078"></A><p>At execution time, no matter what values are in the database
for the column, the crosstab will show only the values that were
specified when the crosstab was defined. In the printer example,
the crosstab will always have the four columns it had when it was
first defined.</p>
<A NAME="TI4079"></A><h4>Making changes</h4>
<A NAME="TI4080"></A><p>You can modify the properties of any of the columns in a static
crosstab. You can modify the properties of each column individually,
since each column is displayed in the workspace as part of the crosstab's
definition. For example, in the printer crosstab you can directly
modify the way values are presented in each individual quarter,
since each quarter is represented in the Design view (the values
are shown as units, units_1, units_2, and units_3).</p>
<A NAME="X-ref305834959"></A><h2>Using property conditional expressions</h2>
<A NAME="TI4081"></A><p>As with other reports, you can specify property conditional
expressions to modify properties at execution time. You can use
them with either dynamic or static crosstabs. With dynamic crosstabs,
you specify an expression once for a column or value, and InfoMaker assigns
the appropriate properties when it builds the individual columns
during execution. With static crosstabs, you have to specify an
expression for each individual column or value because the columns
are already specified at definition time.</p>
<A NAME="TI4082"></A><h4>Example</h4>
<A NAME="TI4083"></A><p>In the following crosstab, an expression has been specified
for Units:</p>
<br><img src="images/cros32.gif">
<A NAME="TI4084"></A><p>Here is the expression, which is for the Font.Weight property
of Units:<pre>if (units &gt; 100, 700, 400)</pre>
</p>
<A NAME="TI4085"></A><p>The expression specifies to use bold font (weight = 700)
if Units is greater than 100. Otherwise, use normal font (weight = 400).</p>
<A NAME="TI4086"></A><p>Here is the crosstab during execution:</p>
<br><img src="images/cros33.gif">
<A NAME="TI4087"></A><p>The large values are shown in bold.</p>
<A NAME="TI4088"></A><p>For more about property conditional expressions,
see <A HREF="imugp72.htm#BFCBCADF">Chapter 8, "Highlighting Information
in Reports and Forms"</A>.</p>

