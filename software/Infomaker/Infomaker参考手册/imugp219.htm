
<html><HEAD>
<LINK REL=STYLESHEET HREF="default.css" TYPE="text/css">
<TITLE>
Percent</TITLE>
</HEAD>
<BODY>
<A NAME="CAIBGEIC"></A><A NAME="TI7440"></A><h1>Percent</h1>
<A NAME="TI7441"></A><p>
<FORM>
<INPUT
 TYPE = "BUTTON"
 VALUE = "Examples"
 onClick = "window.location = 'imugp219.htm#EX71';">
<INPUT
  TYPE = "BUTTON"
 VALUE = "See also"
 onClick = "window.location = 'imugp219.htm#SA71';">
</FORM>
</p>
<h3>Description</h3><A NAME="TI7442"></A><p>Gets the percentage that the current value is of the total
of the values in the column.</p>

<h3>Syntax</h3><pre><b>Percent</b> ( <i>column</i> { FOR <i>range</i> { DISTINCT { <i>expres1</i> {, <i>expres2</i>  {, ... } } } } } )</pre>
<A NAME="TI7443"></A><table cellspacing=0 cellpadding=6 border=1 frame="void" rules="all"><tr><th align="left" valign=bottom><A NAME="TI7444"></A>Argument</th>
<th align="left" valign=bottom><A NAME="TI7445"></A>Description</th>
</tr>
<tr><td valign=top><A NAME="TI7446"></A><i>column</i></td>
<td valign=top><A NAME="TI7447"></A>The column for which you want the value
of each row as a percentage of the total of the values of the column. <i>Column</i> can
be the column name or the column number preceded by a pound sign (#). <i>Column</i> can
also be an expression that includes a reference to the column. The
data type of <i>column</i> must be numeric</td>
</tr>
<tr><td valign=top><A NAME="TI7448"></A>FOR <i>range</i>  (optional)</td>
<td valign=top><A NAME="TI7449"></A>The data that will be included in the
percentage. For most presentation styles, values for <i>range</i> are:<A NAME="TI7450"></A><A NAME="TI7451"></A>
<ul>
<li class=fi>ALL -- (Default)
The percentage that the current value is of all rows in <i>column</i></li>
<li class=ds>GROUP <i>n</i> -- The percentage
that the current value is of rows in <i>column</i> in
the specified group. Specify the keyword GROUP followed by the group
number: for example, GROUP 1</li>
<li class=ds>PAGE -- The percentage that the current
value is of the rows in <i>column</i> on a page
</li>
</ul>
<A NAME="TI7452"></A>For Crosstabs, specify CROSSTAB for <i>range</i>:<A NAME="TI7453"></A><A NAME="TI7454"></A>
<ul>
<li class=fi>CROSSTAB -- (Crosstabs
only) The percentage that the current value is of all rows in <i>column</i> in
the crosstab
</li>
</ul>
<A NAME="TI7455"></A>For Graph and OLE objects, specify one of the following:<A NAME="TI7456"></A><A NAME="TI7457"></A>
<ul>
<li class=fi>GRAPH -- (Graphs
only) The percentage that the current value is of values in <i>column</i> in
the range specified for the Rows option </li>
<li class=ds>OBJECT -- (OLE objects only) The percentage
that the current value is of values in <i>column</i> in
the range specified for the Rows option 
</li>
</ul>
</td>
</tr>
<tr><td valign=top><A NAME="TI7458"></A>DISTINCT (optional)</td>
<td valign=top><A NAME="TI7459"></A>Causes Percent to consider only the distinct
values in <i>column</i> when determining the percentage.
For a value of <i>column</i>, the first row found
with the value is used and other rows that have the same value are
ignored</td>
</tr>
<tr><td valign=top><A NAME="TI7460"></A><i>expresn</i>  (optional)</td>
<td valign=top><A NAME="TI7461"></A>One or more expressions that you want
to evaluate to determine distinct rows. <i>Expresn</i> can
be the name of a column, a function, or an expression</td>
</tr>
</table>

<h3>Return Values</h3><A NAME="TI7462"></A><p>A numeric data type (decimal, double, integer, long, or real).
Returns the percentage the current row of <i>column</i> is
of the total value of the column.</p>

<h3>Usage</h3><A NAME="TI7463"></A><p>Usually you use Percent in a column to display the percentage
for each row. You can also use Percent in a header or trailer for
a group. In the header, it displays the percentage for the first
value in the group and in the trailer for the last value in the
group.</p>
<A NAME="TI7464"></A><p>If you specify <i>range</i>, Percent returns
the percentage the current row of <i>column</i> relative
to the total value of <i>range</i>. For example, if
column 5 is salary, Percent(#5 for group 1) is equivalent
to salary/(Sum(Salary for group 1).</p>
<A NAME="TI7465"></A><p>If you specify DISTINCT, Percent returns the percent the distinct
value in <i>column</i> is of the total value of <i>column</i>,
or if you specify <i>expresn</i>, the percent the
value in <i>column</i> in the row in which the value
of <i>expresn</i> is distinct is of the total for <i>column</i>.</p>
<p><img src="images/note.gif" width=17 height=17 border=0 align="bottom" alt="Note"> <span class=shaded>Formatting the percent value</span> <A NAME="TI7466"></A>The percentage is displayed as a decimal value unless you
specify a format for the result. A display format can be part of
the computed field's definition.</p>
<A NAME="TI7467"></A><p>For graphs and OLE objects, you do not select the range when
you call the function. The range has already been determined by
the Rows setting on the Data property page (the Range property),
and the aggregation function uses that range. Settings for Rows
include:</p>
<A NAME="TI7468"></A><p><A NAME="TI7469"></A>
<ul>
<li class=fi>For the Graph or OLE
presentation style, Rows is always All.</li>
<li class=ds>For Graph controls, Rows can be All, Page, or Group.</li>
<li class=ds>For OLE controls, Rows can be All, Current Row,
Page, or Group. The available choices depend on the layer the control
occupies.
</li>
</ul>
</p>
<A NAME="TI7470"></A><p>NULL values are ignored and are not considered in the calculation.</p>
<p><img src="images/note.gif" width=17 height=17 border=0 align="bottom" alt="Note"> <span class=shaded>Not in validation rules, filter expressions, or crosstabs</span> <A NAME="TI7471"></A>You cannot use Percent or other aggregate functions in validation
rules or filter expressions. Percent does not work for crosstabs;
specifying "for crosstab" as a range is not available for Percent.</p>
<A NAME="TI7472"></A><p>Using an aggregate function cancels the effect of setting
Retrieve Rows As Needed in the painter. To do the aggregation, a
DataWindow object or report always retrieves all rows.</p>

<A NAME="EX71"></A><h3>Examples</h3><A NAME="TI7473"></A><p>This expression returns the value of each row in
the column named salary as a percentage of the total of salary:<pre><i>Percent</i> (salary)</pre>
</p>
<A NAME="TI7474"></A><p>This expression returns the value of each row in
the column named cost as a percentage of the total of cost in group
2:<pre><i>Percent</i> (cost for group 2)</pre>
</p>
<A NAME="TI7475"></A><p>This expression entered in the Value box on the Data
tab page in the Graph Object property sheet returns the value of
each row in the qty_ordered as a percentage of the total
for the column in the graph:<pre><i>Percent</i> (qty_ordered for graph)</pre>
</p>
<A NAME="TI7476"></A><p>Assuming a DataWindow object displays the order number,
amount, and line items for each order, this computed field returns
the order amount as a percentage of the total order amount for the
distinct order numbers:<pre><i>Percent</i> (order_amt for all DISTINCT order_nbr)</pre>
</p>

<A NAME="SA71"></A><h3>See Also</h3><A NAME="TI7477"></A><p><A NAME="TI7478"></A>
<ul>
<li class=fi><A HREF="imugp166.htm#CAICHGHI">CumulativePercent</A> 
</li>
</ul>
</p>


