<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
	<title>格式</title>
	<script type="text/javascript" src="../../mylib/js/css.js"></script>
</head>

<body>
	<p id="title">第N章 格式</p>
	<h1>单位 </h1>
	<p>Excel 中的行高的单位为磅，“磅”(points)是衡量印刷字体大小的单位,约等于七十二分之一英寸。而 1英寸＝25.4毫米，则1磅＝25.4/72≈0.353毫米。</p>
	<p>列宽单位为字符宽度，Excel帮助文件中提到(一个列宽单位等于“常规”样式中一个字符的宽度。对于比例字体，则使用字符“0”（零）的宽度。可用 Width 属性以磅为单位返回列宽。) </p>
	<p>1像素 = 0.26mm</p>
	<p>1字符 = 9.75磅</p>
<h1>条件格式</h1>
	<p>Home -&gt; Conditional Formatting</p>
	<p><img alt="" src="img/conditional_format.png" /></p>
	<h1>颜色</h1>
	<p>颜色索引号如下表所示</p>
	<table style="width: 80%" border="0" cellspacing="0" cellpadding="0">
		<tr>
			<th style="width: 10%">索引值</th>
			<th style="width: 10%">颜色</th>
			<th style="width: 10%">RGB</th>
			<th style="width: 10%">索引值</th>
			<th style="width: 10%">颜色</th>
			<th style="width: 10%">RGB</th>
			<th style="width: 10%">索引值</th>
			<th style="width: 10%">颜色</th>
			<th style="width: 10%">RGB</th>
		</tr>
		<tr>
			<td>1</td>
			<td bgcolor="#000000">&nbsp;</td>
			<td align="center">000000</td>
			<td>2</td>
			<td>&nbsp;</td>
			<td align="center" bgcolor="#FFFFFF">FFFFFF</td>
			<td>3</td>
			<td bgcolor="#FF0000">&nbsp;</td>
			<td align="center">FF0000</td>
		</tr>
		<tr>
			<td>4</td>
			<td bgcolor="#00FF00">&nbsp;</td>
			<td align="center">00FF00</td>
			<td>5</td>
			<td bgcolor="#0000FF">&nbsp;</td>
			<td align="center">0000FF</td>
			<td>6</td>
			<td bgcolor="#FFFF00">&nbsp;</td>
			<td align="center">FFFF00</td>
		</tr>
		<tr>
			<td>7</td>
			<td bgcolor="#FF00FF">&nbsp;</td>
			<td align="center">FF00FF</td>
			<td>8</td>
			<td bgcolor="#00FFFF">&nbsp;</td>
			<td align="center">00FFFF</td>
			<td>9</td>
			<td bgcolor="#800000">&nbsp;</td>
			<td align="center">800000</td>
		</tr>
		<tr>
			<td>10</td>
			<td bgcolor="#008000">&nbsp;</td>
			<td align="center">008000</td>
			<td>11</td>
			<td bgcolor="#000080">&nbsp;</td>
			<td align="center">000080</td>
			<td>12</td>
			<td bgcolor="#808000">&nbsp;</td>
			<td align="center">808000</td>
		</tr>
		<tr>
			<td>13</td>
			<td bgcolor="#800080">&nbsp;</td>
			<td align="center">800080</td>
			<td>14</td>
			<td bgcolor="#008080">&nbsp;</td>
			<td align="center">008080</td>
			<td>15</td>
			<td bgcolor="#C0C0C0">&nbsp;</td>
			<td align="center">C0C0C0</td>
		</tr>
		<tr>
			<td>16</td>
			<td bgcolor="#808080">&nbsp;</td>
			<td align="center">808080</td>
			<td>17</td>
			<td bgcolor="#9999FF">&nbsp;</td>
			<td align="center">9999FF</td>
			<td>18</td>
			<td bgcolor="#993366">&nbsp;</td>
			<td align="center">993366</td>
		</tr>
		<tr>
			<td>19</td>
			<td bgcolor="#FFFFCC">&nbsp;</td>
			<td align="center">FFFFCC</td>
			<td>20</td>
			<td bgcolor="#CCFFFF">&nbsp;</td>
			<td align="center">CCFFFF</td>
			<td>21</td>
			<td bgcolor="#660066">&nbsp;</td>
			<td align="center">660066</td>
		</tr>
		<tr>
			<td>22</td>
			<td bgcolor="#FF8080">&nbsp;</td>
			<td align="center">FF8080</td>
			<td>23</td>
			<td bgcolor="#0066CC">&nbsp;</td>
			<td align="center">0066CC</td>
			<td>24</td>
			<td bgcolor="#CCCCFF">&nbsp;</td>
			<td align="center">CCCCFF</td>
		</tr>
		<tr>
			<td>25</td>
			<td bgcolor="#000080">&nbsp;</td>
			<td align="center">000080</td>
			<td>26</td>
			<td bgcolor="#FF00FF">&nbsp;</td>
			<td align="center">FF00FF</td>
			<td>27</td>
			<td bgcolor="#FFFF00">&nbsp;</td>
			<td align="center">FFFF00</td>
		</tr>
		<tr>
			<td>28</td>
			<td bgcolor="#00FFFF">&nbsp;</td>
			<td align="center">00FFFF</td>
			<td>29</td>
			<td bgcolor="#800080">&nbsp;</td>
			<td align="center">800080</td>
			<td>30</td>
			<td bgcolor="#800000">&nbsp;</td>
			<td align="center">800000</td>
		</tr>
		<tr>
			<td>31</td>
			<td bgcolor="#008080">&nbsp;</td>
			<td align="center">008080</td>
			<td>32</td>
			<td bgcolor="#0000FF">&nbsp;</td>
			<td align="center">0000FF</td>
			<td>33</td>
			<td bgcolor="#00CCFF">&nbsp;</td>
			<td align="center">00CCFF</td>
		</tr>
		<tr>
			<td>34</td>
			<td bgcolor="#CCFFFF">&nbsp;</td>
			<td align="center">CCFFFF</td>
			<td>35</td>
			<td bgcolor="#CCFFCC">&nbsp;</td>
			<td align="center">CCFFCC</td>
			<td>36</td>
			<td bgcolor="#FFFF99">&nbsp;</td>
			<td align="center">FFFF99</td>
		</tr>
		<tr>
			<td>37</td>
			<td bgcolor="#99CCFF">&nbsp;</td>
			<td align="center">99CCFF</td>
			<td>38</td>
			<td bgcolor="#FF99CC">&nbsp;</td>
			<td align="center">FF99CC</td>
			<td>39</td>
			<td bgcolor="#CC99FF">&nbsp;</td>
			<td align="center">CC99FF</td>
		</tr>
		<tr>
			<td>40</td>
			<td bgcolor="#FFCC99">&nbsp;</td>
			<td align="center">FFCC99</td>
			<td>41</td>
			<td bgcolor="#3366FF">&nbsp;</td>
			<td align="center">3366FF</td>
			<td>42</td>
			<td bgcolor="#33CCCC">&nbsp;</td>
			<td align="center">33CCCC</td>
		</tr>
		<tr>
			<td>43</td>
			<td bgcolor="#99CC00">&nbsp;</td>
			<td align="center">99CC00</td>
			<td>44</td>
			<td bgcolor="#FFCC00">&nbsp;</td>
			<td align="center">FFCC00</td>
			<td>45</td>
			<td bgcolor="#FF9900">&nbsp;</td>
			<td align="center">FF9900</td>
		</tr>
		<tr>
			<td>46</td>
			<td bgcolor="#FF6600">&nbsp;</td>
			<td align="center">FF6600</td>
			<td>47</td>
			<td bgcolor="#666699">&nbsp;</td>
			<td align="center">666699</td>
			<td>48</td>
			<td bgcolor="#969696">&nbsp;</td>
			<td align="center">969696</td>
		</tr>
		<tr>
			<td>49</td>
			<td bgcolor="#003366">&nbsp;</td>
			<td align="center">003366</td>
			<td>50</td>
			<td bgcolor="#339966">&nbsp;</td>
			<td align="center">339966</td>
			<td>51</td>
			<td bgcolor="#003300">&nbsp;</td>
			<td align="center">003300</td>
		</tr>
		<tr>
			<td>52</td>
			<td bgcolor="#333300">&nbsp;</td>
			<td align="center">333300</td>
			<td>53</td>
			<td bgcolor="#993300">&nbsp;</td>
			<td align="center">993300</td>
			<td>54</td>
			<td bgcolor="#993366">&nbsp;</td>
			<td align="center">993366</td>
		</tr>
		<tr>
			<td>55</td>
			<td bgcolor="#333399">&nbsp;</td>
			<td align="center">333399</td>
			<td>56</td>
			<td bgcolor="#333333">&nbsp;</td>
			<td align="center">333333</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td align="center">&nbsp;</td>
		</tr>
	</table>
	<p>生成该表的VBA代码如下所示:</p>
	<pre>Sub SetColor()

    Dim iRow As Integer
    Dim iCol As Integer
    Dim iColor As Integer
    Dim r As Excel.Range
    Dim sColor As String
    
    For iColor = 1 To 56
        iRow = 1 + (iColor - 1) \ 7
        iCol = iColor Mod 7
        If iCol = 0 Then iCol = 7
        Set r = ActiveSheet.Cells(iRow, iCol)
        r.Interior.ColorIndex = iColor
        sColor = Hex(r.Interior.Color)
        sColor = Space(6 - Len(sColor)) &amp; sColor
        sColor = Replace(sColor, &quot; &quot;, &quot;0&quot;)
        sColor = Right(sColor, 2) &amp; Mid(sColor, 3, 2) &amp; Left(sColor, 2)
        r.Value2 = CStr(iColor) &amp; &quot; &quot; &amp; sColor
    Next iColor
    
    ActiveSheet.Columns.AutoFit
	
End Sub</pre>
	<p>&nbsp;</p>
	<p>&nbsp;</p>
	<p>&nbsp;</p>

</body>
</html>
