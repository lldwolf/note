<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>使用系统对象完成的功能</title>
<script language="javascript" src="css.js"></script>
</head>

<body>
<h1>第N章 使用系统对象完成的功能</h1>
<hr>
<h2>N.1 数据库</h2>
<h2>N.2 表</h2>
<h3>N.2.1 获取列的默认值</h3>
<pre>--获取表test_table的列test_column的默认值
select c.text as default_value
from sysobjects a
  inner join syscolumns b on b.id = a.id
  left join syscomments c on c.id = b.cdefault
where a.name = 'test_table' and  b.name = 'test_column'</pre>
<h3>N.2.2 获取表的主键</h3>
<pre>--获取dbo用户的test_table表的主键列表
sp_pkeys 'test_table', 'dbo'</pre>
<p>返回结果集的各列说明如下：</p>
<table width="70%"  border="0" cellspacing="0" cellpadding="0">
  <tr>
    <th width="40%">列名</th>
    <th width="60%">说明</th>
  </tr>
  <tr>
    <td>TABLE_QUALIFIER</td>
    <td>所在的数据库</td>
  </tr>
  <tr>
    <td>TABLE_OWNER</td>
    <td>表的所有者</td>
  </tr>
  <tr>
    <td>TABLE_NAME</td>
    <td>表名</td>
  </tr>
  <tr>
    <td>COLUMN_NAME</td>
    <td>主键列名</td>
  </tr>
  <tr>
    <td>KEY_SEQ</td>
    <td>顺序号</td>
  </tr>
  <tr>
    <td>PK_NAME</td>
    <td>在sysobjects表中对应的name，其类型为PK</td>
  </tr>
</table>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<script language="javascript" src="index.js"></script>
</body>
</html>
