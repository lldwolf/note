<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<script language="javascript" src="css.js"></script>
<title>数据类型</title>
</head>

<body>
<h1>第N章 数据类型
</h1>
<h2><a href="#simple_type">N.1 简单类型</a></h2>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#int_type">N.1.1 整型</a></h3>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#char_type">N.1.2 字符</a></h3>
<h2><a href="#date_type">N.2 日期</a></h2>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#date_introduce">N.2.1 简介</a></h3>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#date_func">N.2.2 相关函数</a></h3>
<h2><a href="#array">N.3 数组</a></h2>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#static_array">N.3.1 静态数组</a></h3>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dynamic_array">N.3.2 动态数组</a></h3>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#array_func">N.3.3 与数组相关的函数</a></h3>
<h2><a href="#string">N.4 字符串函数</a></h2>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#str_len">N.4.1 字符串长度</a></h3>
<h3> &nbsp;&nbsp;&nbsp;&nbsp;<a href="#substring">N.4.2 子串</a></h3>
<h3> &nbsp;&nbsp;&nbsp;&nbsp;<a href="#split_string">N.4.3 根据某分隔符将字符串拆分</a></h3>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#instr">N.4.4 判断字符串中是否存在子串</a></h3>
<h2> <a href="#data_type_conversion">N.5 数据类型转换</a></h2>
<h3> &nbsp;&nbsp;&nbsp;&nbsp;<a href="#string_to_number">N.5.1 字符串转为数值</a></h3>
<h3>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#char_to_ascii">N.5.2 字符转换为对应的ASCII码值</a></h3>
<h2><a name="simple_type"></a>N.1 简单类型</h2>
<h3><a name="int_type"></a>N.1.1 整型</h3>
<p>VB中16进制数字的格式为：&amp;H数字，如 &amp;HA1 或 &amp;Ha1</p>
<p>将实型转为整型时，有如下几种方法：</p>
<ul>
  <li>CInt：返回最接近的偶数值，例如0.5返回0，1.5返回2</li>
  <li>Round：四舍五入</li>
  <li>Fix：只取整数部分</li>
</ul>
<h3><a name="char_type"></a>N.1.2 字符</h3>
<p>在VB中，有如下的常数字符</p>
<TABLE cellpadding=4 cellspacing=4 cols=3>

<TR VALIGN="top">
<TH width=22%>常数</TH>
<TH width=28%>等于</TH>
<TH width=50%>描述</TH>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbCrLf</B></TD>
<TD class=T width=28%><B>Chr(</B>13<B>) + Chr(</B>10<B>)</B></TD>
<TD class=T width=50%>回车符与换行符结合</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbCr</B></TD>
<TD class=T width=28%><B>Chr(</B>13<B>)</B></TD>
<TD class=T width=50%>回车符</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbLf</B></TD>
<TD class=T width=28%><B>Chr(</B>10<B>)</B></TD>
<TD class=T width=50%>换行符</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbNewLine</B></TD>
<TD class=T width=28%><B>Chr(</B>13<B>) + Chr(</B>10<B>) </B>or, on the Macintosh, <B>Chr(</B>13<B>)</B></TD>
<TD class=T width=50%>平台指定的新行字符；适用于当前平台</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbNullChar</B></TD>
<TD class=T width=28%><B>Chr(</B>0<B>)</B></TD>
<TD class=T width=50%>值为 0 的字符</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbNullString</B></TD>
<TD class=T width=28%>值为 0 的字符串</TD>
<TD class=T width=50%>用来调用外部过程；与长度为零的字符串 ("") 不同</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbObjectError</B></TD>
<TD class=T width=28%>-2147221504</TD>
<TD class=T width=50%>用户定义的错误号应当大于该值，例如：<BR>
<CODE>Err.Raise Number = vbObjectError + 1000</CODE></TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbTab</B></TD>
<TD class=T width=28%><B>Chr(</B>9<B>)</B></TD>
<TD class=T width=50%>Tab 字。</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbBack</B></TD>
<TD class=T width=28%><B>Chr(</B>8<B>)</B></TD>
<TD class=T width=50%>退格字符</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbFormFeed</B></TD>
<TD class=T width=28%><B>Chr(</B>12<B>)</B></TD>
<TD class=T width=50%>在 Microsoft Windows or on the Macintosh 中没有作用</TD>
</TR>

<TR VALIGN="top">
<TD class=T width=22%><B>vbVerticalTab</B></TD>
<TD class=T width=28%><B>Chr(</B>11<B>)</B></TD>
<TD class=T width=50%>在 Microsoft or on the Macintosh Windows 中没有作用</TD>
</TR>
</TABLE>
<p>可用Chr函数将ASCII码转换为对应字符，如生成回车符可用如下方式：</p>
<pre>Chr(13) </pre>
<h2><a name="date_type"></a>N.2 日期</h2>
<h3><a name="date_introduce"></a>N.2.1 简介</h3>
<p>分为两种类型，日期和时间，声明语法如下：</p>
<pre>Dim 变量名 As Date
Dim 变量名 As Time</pre>
<h3><a name="date_func"></a>N.2.2 相关函数</h3>
<table width="90%"  border="0" cellspacing="0" cellpadding="0">
  <tr>
    <th width="30%">函数</th>
    <th width="70%">说明</th>
  </tr>
  <tr>
    <td>Date</td>
    <td>取当前日期
	<pre>d = Date</pre></td>
  </tr>
  <tr>
    <td>DateValue</td>
    <td>指定日期，例如，指定日期为1995-10-1，可用如下语句
	<pre>d = DateValue("1995-10-1")
d = DateValue("10/1/1995")</pre></td>
  </tr>
  <tr>
    <td>DateSerial</td>
    <td>返回指定年月日的日期，语法如下：
	<pre>DateSerial(year, month, day)</pre></td>
  </tr>
  <tr>
    <td>DateAdd</td>
    <td>为一个日期加上时间间隔，语法如下：
	<pre>DateAdd(interval, number, date)</pre>
	其中interval参数表示要加上去的时间间隔类型，可取以下值：
	<table width="90%"  border="0" cellspacing="0" cellpadding="0">
  <tr>
    <th width="30%">设置</th>
    <th width="70%">描述</th>
  </tr>
  <tr>
    <td>yyyy</td>
    <td>年</td>
  </tr>
  <tr>
    <td>q</td>
    <td>季</td>
  </tr>
  <tr>
    <td>m</td>
    <td>月</td>
  </tr>
  <tr>
    <td>y</td>
    <td>一年的日数</td>
  </tr>
  <tr>
    <td>d</td>
    <td>日</td>
  </tr>
  <tr>
    <td>w</td>
    <td>一周的日数</td>
  </tr>
  <tr>
    <td>ww</td>
    <td>周</td>
  </tr>
  <tr>
    <td>h</td>
    <td>时</td>
  </tr>
  <tr>
    <td>n</td>
    <td>分</td>
  </tr>
  <tr>
    <td>s</td>
    <td>秒</td>
  </tr>
	</table><br/>
	示例，返回1995-10-30后10天的值
	<pre>d = DateValue("1995-10-30")
d = DateAdd("d", 10, d)</pre></td>
  </tr>
  <tr>
    <td>DateDiff</td>
    <td>返回两个指定日期间的时间间隔数目。语法如下：
	<pre>DateDiff(interval, date1, date2[, firstdayofweek[, firstweekofyear]])</pre>
	其中interval的参数说明与DateAdd函数相同，Firstdayofweek 可选。指定一个星期的第一天的常数。如果未予指定，则以星期日为第一天。 firstweekofyear 可选。指定一年的第一周的常数。如果未予指定，则以包含 1 月 1 日的星期为第一周。 </td>
  </tr>
  <tr>
    <td>DatePart</td>
    <td>返回日期的某一部分的值，例如，返回某个日期的月份为多少。语法如下：
	<pre>DatePart(interval, date[,firstdayofweek[, firstweekofyear]])</pre>
	参数说明见DateDiff函数</td>
  </tr>
  <tr>
    <td>Year</td>
    <td>返回一个日期中年部分的值</td>
  </tr>
  <tr>
    <td>Month</td>
    <td>返回一个日期中月部分的值</td>
  </tr>
  <tr>
    <td>Day</td>
    <td>返回一个日期中的天部分的值，其值为1 ~ 31的整数。语法如下：
	<pre>Day(date)</pre></td>
  </tr>
  <tr>
    <td>Weekday</td>
    <td>返回一个日期为星期几，返回值为1 ~ 7，语法如下：
	<pre>Weekday(date, [firstdayofweek])</pre>
	其中Firstdayofweek 可选。指定一星期第一天的常数。如果未予指定，则以 vbSunday 为缺省值。 firstdayofweek 参数有以下设定值：
<table>
<tr>
<th>常数</th>
<th>值</th>
<th>描述</th>
</tr>
<tr>
<td>vbUseSystem</td>
<td>0</td>
<td>使用 NLS API 设置。</td>
</tr>
<tr>
<td>VbSunday</td>
<td>1</td>
<td>星期日（缺省值）</td>
</tr>
<tr>
<td>vbMonday</td>
<td>2</td>
<td>星期一</td>
</tr>
<tr>
<td>vbTuesday</td>
<td>3</td>
<td>星期二</td>
</tr>
<tr>
<td>vbWednesday</td>
<td>4</td>
<td>星期三</td>
</tr>
<tr>
<td>vbThursday</td>
<td>5</td>
<td>星期四</td>
</tr>
<tr>
<td>vbFriday</td>
<td>6</td>
<td>星期五</td>
</tr>
<tr>
<td>vbSaturday</td>
<td>7</td>
<td>星期六</td>
</tr>
</table>
<br/>
该函数返回以下值，说明如下：
<table>
<tr>
<th>常数</th>
<th>值</th>
<th>描述</th>
</tr>
<tr>
<td>vbSunday</td>
<td>1</td>
<td>星期日</td>
</tr>
<tr>
<td>vbMonday</td>
<td>2</td>
<td>星期一</td>
</tr>
<tr>
<td>vbTuesday</td>
<td>3</td>
<td>星期二</td>
</tr>
<tr>
<td>vbWednesday</td>
<td>4</td>
<td>星期三</td>
</tr>
<tr>
<td>vbThursday</td>
<td>5</td>
<td>星期四</td>
</tr>
<tr>
<td>vbFriday</td>
<td>6</td>
<td>星期五</td>
</tr>
<tr>
<td>vbSaturday</td>
<td>7</td>
<td>星期六</td>
</tr>
</table>


	</td>
  </tr>
  <tr>
    <td>Now</td>
    <td>返回当前日期和时间</td>
  </tr>
  <tr>
    <td>Time</td>
    <td>返回当前时间</td>
  </tr>
  <tr>
    <td>Hour</td>
    <td>返回某个Time型值的小时部分</td>
  </tr>
  <tr>
    <td>Minute</td>
    <td>返回某个Time型值的分钟部分</td>
  </tr>
  <tr>
    <td>Second</td>
    <td>返回某个Time型值的秒部分</td>
  </tr>
</table>
<h2><a name="array"></a>N.3 数组</h2>
<h3><a name="static_array"></a>N.3.1 静态数组</h3>
<pre>dim a1(0 to 10) as Integer
dim a2(10) as Integer					'默认下标从0开始，默认下标由选项Option Base语句设置
dim a3(10, 10) as Integer				'多维数组</pre>
<h3><a name="dynamic_array"></a>N.3.2 动态数组</h3>
<pre>dim a() as Integer
ReDim a(10)			'重设数组大小
Redim Preserve a(20)		'重设数组大小，并保留数组已有的值</pre>
<h3><a name="array_func"></a>N.3.3 与数组相关的函数</h3>
<h4>N.3.3.1 LBound和UBound</h4>
<p>返回数组的最小和最大下标值</p>
<h2><a name="string"></a>N.4 字符串函数</h2>
<table width="80%" >
  <tr>
    <th width="25%">函数名</th>
    <th width="75%">描述</th>
  </tr>
  <tr>
    <td>Hex</td>
    <td>返回数字的16进制形式</td>
  </tr>
  <tr>
    <td><a href="#instr">InStr</a></td>
    <td>判断字符串中是否存在子串，从前向后搜索</td>
  </tr>
  <tr>
    <td><a href="#instrrev">InStrRev</a></td>
    <td>判断字符串中是否存在子串，从后向前搜索</td>
  </tr>
  <tr>
    <td><a href="#str_len">Len</a></td>
    <td>取字符串长度</td>
  </tr>
  <tr>
    <td><a href="#substring">Left</a></td>
    <td>从左取子串</td>
  </tr>
  <tr>
    <td><a href="#substring">Mid</a></td>
    <td>取子串</td>
  </tr>
  <tr>
    <td><a href="#substring">Right</a></td>
    <td>从右取子串</td>
  </tr>
  <tr>
    <td>Space</td>
    <td>返回指定长度的空字符串</td>
  </tr>
  <tr>
    <td><a href="#split_string">Split</a></td>
    <td>拆分字符串</td>
  </tr>
  <tr>
    <td>StrReverse</td>
    <td>字符串反转</td>
  </tr>
</table>
<h3><a name="str_len"></a>N.4.1 字符串长度</h3>
<pre>dim s as String
dim a as Integer
a = Len(s)</pre>
<h3><a name="substring"></a>N.4.2 子串</h3>
<pre>dim str as String 
dim s1 as String
dim s2 as String 
dim s3 as String

str = "12345"
s1 = Left(str, 2)		'从左边取2个字符
s2 = Right(str, 2)		'从右边取2个字符
s3 = Mid(str, 2, 3)		'从第2个字符起，取3个字符</pre>
<p>注意：字符串的下标从1开始，而不是从0开始</p>
<h3><a name="split_string"></a>N.4.3 根据某分隔符将字符串拆分</h3>
<pre>Dim str as String
Dim s() as String
str = "1,2,3"
s = Split(str, ",")</pre>
<h3>N.4.4 判断字符串中是否存在子串</h3>
<h4><a name="instr"></a>InStr函数</h4>
<p>返回 <B>Variant</B> (<B>Long</B>)，指定一字符串在另一字符串中最先出现的位置。</p>
<p><B>InStr</B>([<B><I>start</I></B>, ]<B><I>string1</I></B>, <B><I>string2</I></B>[, <B><I>compare</I></B>])</p>
<p>返回值从1开始，找不到的话返回0</p>
<h4><a name="instrrev"></a>InStrRev</h4>
<p>返回一个字符串在另一个字符串中出现的位置，从字符串的末尾算起。</p>
<p><B>InstrRev(<I>stringcheck</I>,</B> <B><I>stringmatch</I></B>[<B>,</B> <B><I>start</I></B>[<B>,</B> <B><I>compare</I></B>]]<B>)</B></p>
<h2><a name="data_type_conversion"></a>N.5 数据类型转换</h2>
<table width="80%" >
  <tr>
    <th width="25%">&nbsp;</th>
    <th width="75%">&nbsp;</th>
  </tr>
  <tr>
    <td>Asc</td>
    <td>返回字符对应的ASCII码</td>
  </tr>
  <tr>
    <td>CBool</td>
    <td>将表达式转为Boolean型，字符串为True或False</td>
  </tr>
  <tr>
    <td>CByte</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>CCur</td>
    <td>-922,337,203,685,477.5808 至922,337,203,685,477.5807。</td>
  </tr>
  <tr>
    <td>CDate</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>CDbl</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>CDec</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>CInt</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>CLng</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>CSng</td>
    <td>Single</td>
  </tr>
  <tr>
    <td>CStr</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>CVar</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Chr</td>
    <td>将ASCII码转换为字符</td>
  </tr>
  <tr>
    <td>Hex</td>
    <td>将数字转为16进制字符串</td>
  </tr>
  <tr>
    <td>Val</td>
    <td>将字符串转换数值</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<p>&nbsp;</p>
<h3><a name="string_to_number"></a>N.5.1 字符串转为数值</h3>
<pre>Dim str as String 
Dim a as Integer
str = "124"
a = Val(str)
</pre>
<h3><a name="char_to_ascii"></a>N.5.2 字符转换为对应的ASCII码值</h3>
<p>Asc函数</p>
<p>&nbsp;</p>
<script language="javascript" src="index.js"></script>
</body>
</html>
